<?php
session_start();
if (!isset($_SESSION['usuario_id'])) {
    header("Location: login.php");
    exit;
}
?>
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/x-icon" href="../img/logo_fondo.ico">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/tts.css">
  <script src="../js/main.js"></script>
  <script src="../js/tts.js"></script>
  <script src="../js/session.js"></script>
  <title>InTouch - Texto a Voz</title>
</head>
<body>
  <main class="app" role="main">
    <header>
      <img src="../img/logo.png" alt="Logo InTouch" class="logo"/>
      <h4 class="chip">Â¡Hola, <?php echo htmlspecialchars($_SESSION['usuario']); ?>!</h4>
    </header>

    <section class="bar" aria-label="InformaciÃ³n">
      <div id="info" class="sentence" aria-live="polite" aria-atomic="false">
        <span class="chip"><small>ğŸ¤</small> Texto a Voz Libre</span>
      </div>
    </section>

    <section class="tts-section">
      <div class="tts-card">
        <h2>ğŸ¤ Texto a Voz</h2>
        <p>EscribÃ­ cualquier texto y escuchalo en voz alta</p>

        <div class="tts-controls">
          <div class="control-group">
            <label for="voiceSelect">ğŸ­ Voz:</label>
            <select id="voiceSelect" aria-label="Seleccionar voz">
              <option>Cargando voces...</option>
            </select>
          </div>

          <div class="control-group">
            <label for="rate">âš¡ Velocidad: <span id="rateValue">1.0</span></label>
            <input id="rate" type="range" min="0.5" max="2.0" step="0.1" value="1" />
          </div>

          <div class="control-group">
            <label for="pitch">ğŸµ Tono: <span id="pitchValue">1.0</span></label>
            <input id="pitch" type="range" min="0.5" max="2.0" step="0.1" value="1" />
          </div>
        </div>

        <div class="text-input-area">
          <textarea
            id="freeText"
            placeholder="EscribÃ­ tu texto acÃ¡...&#10;&#10;Por ejemplo:&#10;Hola, Â¿cÃ³mo estÃ¡s?&#10;Me gustarÃ­a comer una pizza.&#10;Gracias por tu ayuda."
            aria-label="Texto a convertir en voz"
          ></textarea>
        </div>

        <div class="tts-actions">
          <button id="speakText" class="btn-primary">
            <span class="btn-icon">ğŸ”Š</span>
            Leer Texto
          </button>
          <button id="stopSpeech" class="btn-danger">
            <span class="btn-icon">â¹ï¸</span>
            Detener
          </button>
        </div>

        <div class="tts-status" id="ttsStatus" style="display: none;">
          <span class="status-icon" id="ttsStatusIcon">ğŸµ</span>
          <span class="status-text" id="ttsStatusText">Reproduciendo...</span>
        </div>
      </div>
    </section>

    <footer>
      <p>Â© InTouch - 2025</p>
    </footer>
  </main>

  <button class="menufloat" id="menufloat" onclick="mostrarMenu()">+</button>
  <section class="subButton-container">
    <button class="btn-admin" onclick="irAAdmin()" title="Panel de AdministraciÃ³n">
      âš™ï¸
    </button>
    <button class="btn-tts" onclick="irATTS()" title="Texto a Voz">
      ğŸ¤
    </button>
    <button class="btn-logout" onclick="irALOGOUT()" title="Cerrar SesiÃ³n">
      âŒ
    </button>
  </section>

  <script src="../js/mostrar_menu.js"></script>
</body>
</html>